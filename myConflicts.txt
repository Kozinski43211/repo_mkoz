changes from data_fix branch